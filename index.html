<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>طلب إعلان | إيهاب جي إم</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background: #f8f9fa;
            margin: 0;
            padding: 0;
        }
        form {
            background: white;
            padding: 30px;
            max-width: 700px;
            margin: 50px auto;
            border-radius: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
        }
        label {
            font-weight: bold;
            margin-top: 15px;
            display: block;
        }
        input, textarea {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        button {
            margin-top: 20px;
            padding: 12px 20px;
            background: #d10000;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <form id="adForm">
        <label>اسم النشاط:</label>
        <input type="text" id="companyName" required>
        <label>اسم المسؤول:</label>
        <input type="text" id="responsibleName" required>
        <label>رقم الهاتف:</label>
        <input type="text" id="phone" required>
        <label>رابط الموقع أو فيسبوك:</label>
        <input type="text" id="website">
        <label>مجال النشاط:</label>
        <input type="text" id="industry">
        <label>رابط الصفحة المقصودة:</label>
        <input type="text" id="landing">
        <label>نوع الإعلان:</label>
        <input type="text" id="adType">
        <label>منصة العرض:</label>
        <input type="text" id="platform">
        <label>بداية الإعلان:</label>
        <input type="date" id="startDate">
        <label>نهاية الإعلان:</label>
        <input type="date" id="endDate">
        <label>الميزانية:</label>
        <input type="text" id="budget">
        <label>ملاحظات:</label>
        <textarea id="notes"></textarea>
        <label>رقم واتساب:</label>
        <input type="text" id="whatsapp">
        <button type="submit">إرسال الطلب</button>
    </form>

    <script>
        const SHEET_ID = "18SgrfICcbrOHwxc31jNASq9UCaeIQNTzoeiOAYX1-S8";
        const API_KEY = "AIzaSyDyOo6oKozoke4VDh7F9l5E5GhXAth55cA";
        const RANGE = "Sheet1!A1";

        async function sendToSheet(formData) {
            const values = [[
                formData.companyName, formData.responsibleName, formData.phone, formData.website,
                formData.industry, formData.landing, formData.adType, formData.platform,
                formData.startDate, formData.endDate, formData.budget, formData.notes,
                "", "", formData.whatsapp
            ]];

            const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${RANGE}:append?valueInputOption=USER_ENTERED&key=${API_KEY}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ values })
            });

            if (!response.ok) {
                const errorText = await response.text();
                throw new Error("❌ فشل في إرسال البيانات:\n" + errorText);
            }

            return await response.json();
        }

        document.getElementById("adForm").addEventListener("submit", async function(event) {
            event.preventDefault();
            const formData = {
                companyName: document.getElementById("companyName").value,
                responsibleName: document.getElementById("responsibleName").value,
                phone: document.getElementById("phone").value,
                website: document.getElementById("website").value,
                industry: document.getElementById("industry").value,
                landing: document.getElementById("landing").value,
                adType: document.getElementById("adType").value,
                platform: document.getElementById("platform").value,
                startDate: document.getElementById("startDate").value,
                endDate: document.getElementById("endDate").value,
                budget: document.getElementById("budget").value,
                notes: document.getElementById("notes").value,
                whatsapp: document.getElementById("whatsapp").value
            };

            try {
                await sendToSheet(formData);
                alert("✅ تم إرسال الطلب بنجاح!");
                document.getElementById("adForm").reset();
            } catch (err) {
                console.error(err);
                alert("❌ فشل إرسال البيانات إلى Google Sheets. راجع التفاصيل في Console.");
            }
        });
    </script>
</body>
</html>
